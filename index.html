<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5">
<title>Hair Tattoo ‚Äî Find SMP & Scalp Micropigmentation Artists Near You</title>
<meta name="description" content="Hair Tattoo is the #1 directory for scalp micropigmentation (SMP) professionals. Browse 400+ verified artists across the US. Compare services, view portfolios, and connect instantly.">
<meta name="keywords" content="scalp micropigmentation, SMP, SMP near me, scalp tattoo, micropigmentation near me, hair restoration, smp artist, hair loss solution, best SMP artist, SMP cost">
<link rel="canonical" href="https://hairtattoo.com">
<meta property="og:title" content="Hair Tattoo ‚Äî Find SMP Artists Near You">
<meta property="og:description" content="The #1 directory for scalp micropigmentation professionals. Browse 400+ verified artists.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://hairtattoo.com">
<meta property="og:site_name" content="Hair Tattoo">
<meta name="twitter:card" content="summary_large_image">
<meta name="robots" content="index, follow">
<meta name="theme-color" content="#2D5A3D">
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíà</text></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://ingorrzmoudvoknhwjjb.supabase.co">
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link rel="preload" href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,700&family=Instrument+Serif:ital@0;1&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,700&family=Instrument+Serif:ital@0;1&display=swap"></noscript>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#FAFAF8;--card:#FFF;--text:#1A1A1A;--t2:#555;--t3:#888;--ac:#2D5A3D;--ac2:#3A7350;--al:#E8F0EB;--bd:#E8E6E3;--sh:0 1px 3px rgba(0,0,0,.06);--r:12px;--rs:8px;--f:'DM Sans',system-ui,sans-serif;--se:'Instrument Serif',Georgia,serif}
html{font-size:16px;scroll-behavior:smooth}
body{font-family:var(--f);background:var(--bg);color:var(--text);line-height:1.5;-webkit-font-smoothing:antialiased}
a{color:var(--ac);text-decoration:none}
button{font-family:var(--f);cursor:pointer;border:none;background:none}
input,textarea,select{font-family:var(--f);font-size:1rem}

.nav{position:sticky;top:0;z-index:100;background:rgba(250,250,248,.92);backdrop-filter:blur(12px);border-bottom:1px solid var(--bd);padding:0 1rem}
.nav-in{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;height:56px}
.logo{font-family:var(--se);font-size:1.5rem;color:var(--text);letter-spacing:-.02em;cursor:pointer}
.logo span{color:var(--ac)}
.nav-r{display:flex;gap:.75rem;align-items:center}
.nav-r a{color:var(--t2);font-size:.875rem;font-weight:500;transition:color .15s}
.nav-r a:hover{color:var(--ac)}
.nav-dd{position:relative}
.nav-dd-btn{display:inline-flex;align-items:center;gap:.375rem;padding:.5rem 1rem;border-radius:var(--rs);font-size:.875rem;font-weight:500;background:var(--ac);color:#fff;transition:background .15s;cursor:pointer;border:none;font-family:var(--f)}
.nav-dd-btn:hover{background:var(--ac2)}
.nav-dd-btn svg{width:12px;height:12px;fill:none;stroke:currentColor;stroke-width:2.5;transition:transform .2s}
.nav-dd.open .nav-dd-btn svg{transform:rotate(180deg)}
.nav-menu{display:none;position:absolute;right:0;top:calc(100% + 6px);background:var(--card);border:1px solid var(--bd);border-radius:var(--rs);box-shadow:0 8px 24px rgba(0,0,0,.1);min-width:200px;padding:.375rem;z-index:110}
.nav-dd.open .nav-menu{display:block}
.nav-menu a{display:block;padding:.5rem .75rem;border-radius:6px;font-size:.875rem;color:var(--text);font-weight:400;transition:background .1s}
.nav-menu a:hover{background:var(--al)}
.nav-menu a.primary{font-weight:600;color:var(--ac)}
.nav-menu .nm-sep{height:1px;background:var(--bd);margin:.25rem .5rem}
.hamburger{display:none;width:36px;height:36px;align-items:center;justify-content:center;cursor:pointer;border-radius:var(--rs);transition:background .15s}
.hamburger:hover{background:var(--al)}
.hamburger svg{width:20px;height:20px;fill:none;stroke:var(--text);stroke-width:2;stroke-linecap:round}
.mob-menu{display:none;position:fixed;inset:0;z-index:150;background:rgba(0,0,0,.4)}
.mob-menu.open{display:block}
.mob-drawer{position:fixed;top:0;right:-300px;width:280px;max-width:85vw;height:100vh;background:var(--card);z-index:151;box-shadow:-4px 0 20px rgba(0,0,0,.1);transition:right .3s ease;padding:1.25rem}
.mob-menu.open .mob-drawer{right:0}
.mob-drawer .mob-close{float:right;font-size:1.25rem;color:var(--t3);cursor:pointer;line-height:1}
.mob-drawer nav{clear:both;padding-top:1rem}
.mob-drawer nav a{display:block;padding:.75rem 0;font-size:1rem;color:var(--text);border-bottom:1px solid var(--bd)}
.mob-drawer nav a:last-child{border-bottom:none}
.btn{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border-radius:var(--rs);font-size:.875rem;font-weight:500;transition:all .15s}
.btn-p{background:var(--ac);color:#fff}.btn-p:hover{background:var(--ac2)}
.btn-o{border:1px solid var(--bd);color:var(--text)}.btn-o:hover{border-color:var(--ac);color:var(--ac)}

.hero{padding:3rem 1rem 1.5rem;text-align:center;max-width:700px;margin:0 auto}
.hero h1{font-family:var(--se);font-size:clamp(2rem,5vw,3.25rem);font-weight:400;line-height:1.15;margin-bottom:.75rem;letter-spacing:-.02em}
.hero h1 em{font-style:italic;color:var(--ac)}
.hero p{color:var(--t2);font-size:1.0625rem;max-width:520px;margin:0 auto 1.25rem}
.hero-btns{display:flex;gap:.5rem;justify-content:center;flex-wrap:wrap;margin-bottom:.5rem}

.search-wrap{max-width:600px;margin:0 auto 1.5rem;padding:0 1rem}
.search-bar{display:flex;background:var(--card);border:1.5px solid var(--bd);border-radius:var(--r);overflow:hidden;box-shadow:var(--sh);transition:border-color .2s}
.search-bar:focus-within{border-color:var(--ac)}
.search-bar input{flex:1;padding:.75rem 1rem;border:none;outline:none;background:transparent;min-width:0}
.s-loc{border-left:1px solid var(--bd);display:flex;align-items:center;gap:.25rem;padding:0 .75rem;font-size:.875rem;color:var(--t2);min-width:120px}
.s-loc input{padding:.75rem 0;border:none;outline:none;background:transparent;font-size:.875rem;width:100%}
.s-btn{background:var(--ac);color:#fff;padding:.625rem 1rem;font-weight:500;font-size:.875rem;margin:4px;border-radius:var(--rs);white-space:nowrap}
.s-btn:hover{background:var(--ac2)}

.tabs{max-width:1200px;margin:0 auto;padding:0 1rem;display:flex;gap:0;border-bottom:1px solid var(--bd);margin-bottom:1.5rem}
.tab{padding:.75rem 1.25rem;font-size:.875rem;font-weight:500;color:var(--t2);border-bottom:2px solid transparent;transition:all .15s}
.tab:hover{color:var(--text)}.tab.on{color:var(--ac);border-color:var(--ac)}

.filters{max-width:1200px;margin:0 auto 1rem;padding:0 1rem;display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}
.chip{padding:.375rem .75rem;border:1px solid var(--bd);border-radius:20px;font-size:.8125rem;color:var(--t2);background:var(--card);transition:all .15s;white-space:nowrap}
.chip:hover,.chip.on{border-color:var(--ac);color:var(--ac);background:var(--al)}
.fcount{font-size:.8125rem;color:var(--t3);margin-left:auto}

.main{max-width:1200px;margin:0 auto;padding:0 1rem 3rem}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(310px,1fr));gap:1rem}

.card{background:var(--card);border:1px solid var(--bd);border-radius:var(--r);overflow:hidden;transition:box-shadow .15s,transform .1s;cursor:pointer;opacity:0;animation:fadeUp .3s ease forwards}
.card:hover{box-shadow:0 4px 20px rgba(0,0,0,.08);transform:translateY(-2px)}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
.card:nth-child(1){animation-delay:.02s}.card:nth-child(2){animation-delay:.04s}.card:nth-child(3){animation-delay:.06s}
.card:nth-child(4){animation-delay:.08s}.card:nth-child(5){animation-delay:.1s}.card:nth-child(6){animation-delay:.12s}
.c-head{padding:1.25rem 1.25rem .5rem;display:flex;gap:.75rem;align-items:flex-start}
.c-av{width:44px;height:44px;border-radius:50%;background:var(--al);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-family:var(--se);font-size:1.125rem;color:var(--ac);overflow:hidden}
.c-info{flex:1;min-width:0}
.c-name{font-weight:700;font-size:.9375rem;line-height:1.3;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.c-loc{font-size:.8125rem;color:var(--t2);margin-top:1px}
.c-badge{font-size:.6875rem;font-weight:600;padding:.125rem .5rem;border-radius:4px;white-space:nowrap}
.c-badge-verified{color:var(--ac);background:var(--al)}
.c-badge-claimed{color:var(--t3);background:#f0eeeb}
.c-body{padding:0 1.25rem .5rem}
.c-about{font-size:.8125rem;color:var(--t2);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.c-tags{padding:0 1.25rem .75rem;display:flex;flex-wrap:wrap;gap:.25rem}
.c-tag{font-size:.6875rem;padding:.125rem .5rem;background:var(--al);color:var(--ac);border-radius:4px}
.c-img{position:relative;width:100%;height:180px;overflow:hidden;background:var(--al)}
.c-img img{width:100%;height:100%;object-fit:cover;display:block}
.c-pill{position:absolute;bottom:8px;left:8px;background:rgba(255,255,255,.85);backdrop-filter:blur(4px);padding:2px 8px;border-radius:12px;font-size:.625rem;color:var(--t2);pointer-events:none}
.c-foot{padding:.5rem 1.25rem;border-top:1px solid var(--bd);display:flex;align-items:center;justify-content:space-between;font-size:.8125rem}
.c-views{color:var(--t3);display:flex;align-items:center;gap:.25rem;font-size:.75rem}
.c-msg{color:var(--ac);font-weight:500;display:flex;align-items:center;gap:.25rem;cursor:pointer;transition:color .15s}
.c-msg:hover{color:var(--ac2)}
.msg-overlay{display:none;position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.4)}
.msg-overlay.open{display:block}
.msg-panel{position:fixed;top:0;right:-420px;width:400px;max-width:90vw;height:100vh;background:var(--card);z-index:201;box-shadow:-4px 0 20px rgba(0,0,0,.1);transition:right .3s ease;display:flex;flex-direction:column;overflow:hidden}
.msg-panel.open{right:0}
.msg-panel-head{padding:1.25rem;border-bottom:1px solid var(--bd);display:flex;align-items:center;justify-content:space-between}
.msg-panel-head h3{font-size:1rem;font-weight:700}
.msg-panel-body{flex:1;overflow-y:auto;padding:1.25rem}
.msg-panel-body label.mp-label{display:block;font-size:.8125rem;font-weight:500;margin-bottom:.25rem;color:var(--text)}
.msg-panel-body input[type="text"],.msg-panel-body input[type="tel"],.msg-panel-body textarea{width:100%;padding:.625rem .75rem;border:1px solid var(--bd);border-radius:var(--rs);outline:none;font-size:.875rem;margin-bottom:.75rem;transition:border-color .15s;font-family:var(--f);background:#fff}
.msg-panel-body input:focus,.msg-panel-body textarea:focus{border-color:var(--ac)}
.msg-panel-body textarea{resize:vertical;min-height:80px}
.msg-svcs{display:flex;flex-wrap:wrap;gap:.375rem;margin-bottom:.75rem}
.msg-svc{font-size:.75rem;padding:.25rem .625rem;border:1px solid var(--bd);border-radius:20px;cursor:pointer;transition:all .15s;background:var(--card);color:var(--t2)}
.msg-svc.on{border-color:var(--ac);background:var(--al);color:var(--ac)}
.msg-consent{display:flex;align-items:flex-start;gap:.5rem;margin-bottom:1rem;font-size:.75rem;color:var(--t2)}
.msg-consent input[type="checkbox"]{margin-top:2px;flex-shrink:0}
.msg-submit{width:100%;padding:.75rem;background:var(--ac);color:#fff;border-radius:var(--rs);font-weight:600;font-size:.875rem;transition:background .15s}
.msg-submit:hover{background:var(--ac2)}
.msg-ok{text-align:center;padding:2rem 1rem}
.msg-ok h4{font-size:1.125rem;margin-bottom:.5rem;color:var(--ac)}
.msg-ok p{color:var(--t2);font-size:.875rem;margin-bottom:1rem}

/* EXPLORE FEED */
.explore-wrap{max-width:700px;margin:0 auto;padding:0 1rem 3rem}
.explore-toggle{display:flex;align-items:center;gap:12px;margin-bottom:1.25rem}
.explore-toggle .toggle-group{display:flex;background:#F0EFEB;border-radius:10px;padding:3px}
.explore-toggle .toggle-btn{padding:6px 12px;border:none;background:none;cursor:pointer;border-radius:8px;font-size:.875rem;color:#888;font-family:var(--f);transition:all .2s}
.explore-toggle .toggle-btn.active{background:#fff;color:var(--ac);box-shadow:0 1px 3px rgba(0,0,0,.1)}
.explore-count{color:#888;font-size:.8125rem}
.ex-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:4px}
.ex-grid-item{aspect-ratio:1;overflow:hidden;cursor:pointer;position:relative;background:var(--al)}
.ex-grid-item img{width:100%;height:100%;object-fit:cover;transition:transform .3s;display:block}
.ex-grid-item:hover img{transform:scale(1.05)}
.ex-grid-txt{background:#F5F4F0;display:flex;align-items:center;justify-content:center;padding:1rem;text-align:center}
.ex-grid-txt p{font-size:.8125rem;color:#444;line-height:1.4;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}

/* DETAIL PAGE */
.detail-page{display:none;max-width:720px;margin:0 auto;padding:1rem 1rem 3rem}
.dp-back{font-size:.875rem;color:var(--t2);display:inline-flex;align-items:center;gap:.375rem;margin-bottom:1.25rem;padding:.375rem 0}
.dp-back:hover{color:var(--ac)}
.dp-header{display:flex;gap:1.25rem;align-items:flex-start;margin-bottom:1.5rem}
.dp-av{width:80px;height:80px;border-radius:50%;background:var(--al);display:flex;align-items:center;justify-content:center;font-family:var(--se);font-size:2rem;color:var(--ac);flex-shrink:0}
.dp-info{flex:1;min-width:0}
.dp-name{font-size:1.5rem;font-weight:700;line-height:1.2;margin-bottom:.25rem}
.dp-loc{color:var(--t2);font-size:.9375rem;margin-bottom:.25rem}
.dp-badge{display:inline-flex;align-items:center;gap:.375rem;font-size:.8125rem;font-weight:600;margin-top:.25rem}
.dp-badge-verified{color:var(--ac)}
.dp-badge-featured{color:#D4A853}
.featured-section{max-width:1200px;margin:0 auto;padding:0 1rem 1.5rem}
.featured-section h2{font-family:var(--se);font-size:1.25rem;font-weight:400;margin-bottom:.75rem}
.featured-row{display:flex;gap:1rem;overflow-x:auto;scrollbar-width:none;-webkit-overflow-scrolling:touch;padding-bottom:.5rem}
.featured-row::-webkit-scrollbar{display:none}
.featured-row .card{min-width:320px;max-width:360px;flex-shrink:0;border:2px solid #D4A853;border-radius:16px;box-shadow:0 2px 12px rgba(212,168,83,.15)}
.c-featured-pill{position:absolute;top:8px;left:8px;background:rgba(212,168,83,.9);backdrop-filter:blur(4px);padding:2px 8px;border-radius:12px;font-size:.625rem;color:#fff;font-weight:600;pointer-events:none;z-index:1}
.dp-socials{display:flex;gap:.5rem;margin-top:.5rem}
.dp-social{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .625rem;background:var(--al);border-radius:20px;font-size:.75rem;font-weight:500;color:var(--ac);transition:all .15s}
.dp-social:hover{background:var(--ac);color:#fff}
.dp-claim{background:linear-gradient(135deg,var(--ac),var(--ac2));color:#fff;padding:.75rem 1rem;border-radius:var(--rs);display:flex;align-items:center;gap:.75rem;font-size:.8125rem;margin-bottom:1.25rem}
.dp-claim button{background:rgba(255,255,255,.2);color:#fff;padding:.25rem .75rem;border-radius:4px;font-size:.8125rem;font-weight:500;white-space:nowrap}
.dp-claim button:hover{background:rgba(255,255,255,.35)}
.dp-section{background:var(--card);border:1px solid var(--bd);border-radius:var(--r);padding:1.25rem;margin-bottom:1rem}
.dp-section h3{font-size:.6875rem;text-transform:uppercase;letter-spacing:.08em;color:var(--t3);margin-bottom:.625rem;font-weight:600}
.dp-about{font-size:.9375rem;color:var(--t2);line-height:1.7}
.dp-svcs{display:flex;flex-wrap:wrap;gap:.375rem}
.dp-svcs span{font-size:.8125rem;padding:.25rem .75rem;background:var(--al);color:var(--ac);border-radius:6px}
.dp-grid{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
.dp-det label{display:block;font-size:.6875rem;color:var(--t3);text-transform:uppercase;letter-spacing:.04em;margin-bottom:2px}
.dp-det a{color:var(--ac);word-break:break-all;font-size:.875rem}
.dp-det span{font-size:.875rem;color:var(--text)}

/* CONTACT FORM */
.cf{background:var(--card);border:1px solid var(--bd);border-radius:var(--r);padding:1.25rem;margin-bottom:1rem}
.cf h3{font-size:.9375rem;font-weight:700;color:var(--ac);margin-bottom:.75rem}
.cf-row{display:flex;gap:.5rem;margin-bottom:.5rem}
.cf-row input,.cf-row textarea{flex:1;padding:.625rem .75rem;border:1px solid var(--bd);border-radius:var(--rs);outline:none;font-size:.875rem;background:#fff;transition:border-color .15s}
.cf-row input:focus,.cf-row textarea:focus{border-color:var(--ac)}
.cf-row textarea{resize:vertical;min-height:72px}
.cf-sub{width:100%;padding:.625rem;background:var(--ac);color:#fff;border-radius:var(--rs);font-weight:600;font-size:.875rem}
.cf-sub:hover{background:var(--ac2)}
.cf-ok{text-align:center;padding:.75rem;color:var(--ac);font-weight:500;font-size:.875rem}

footer{background:var(--text);color:#ccc;padding:3rem 1rem;text-align:center;font-size:.8125rem}
footer h4{font-family:var(--se);font-size:1.25rem;color:#fff;margin-bottom:.5rem}
footer p{max-width:500px;margin:0 auto .75rem;line-height:1.6}
.f-links{display:flex;gap:1.5rem;justify-content:center;margin-top:1rem;flex-wrap:wrap}
.f-links a{color:#aaa;font-size:.8125rem}.f-links a:hover{color:#fff}
.fc-wrap{margin:1.5rem auto;max-width:700px;text-align:left}
.fc-label{font-size:.6875rem;color:#888;margin-bottom:.5rem;text-transform:uppercase;letter-spacing:.06em}
.fc-grid{display:flex;flex-wrap:wrap;gap:.375rem}
.fc-link{font-size:.75rem;color:#aaa;padding:.25rem .5rem;border:1px solid #444;border-radius:4px;white-space:nowrap;transition:all .15s}
.fc-link:hover{color:#fff;border-color:#888}

.empty{text-align:center;padding:3rem 1rem;color:var(--t2)}
.empty h3{font-size:1.125rem;margin-bottom:.5rem;color:var(--text)}

.pager{display:flex;justify-content:center;gap:.5rem;padding:2rem 0}
.pager button{padding:.375rem .75rem;border:1px solid var(--bd);border-radius:var(--rs);font-size:.875rem;color:var(--t2);background:var(--card)}
.pager button:hover{border-color:var(--ac);color:var(--ac)}
.pager button.on{background:var(--ac);color:#fff;border-color:var(--ac)}

.icon{width:16px;height:16px;fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;vertical-align:middle}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
@keyframes shimmer{0%{background-position:-400px 0}100%{background-position:400px 0}}
.skel{background:linear-gradient(90deg,var(--bd) 25%,#f0eeeb 50%,var(--bd) 75%);background-size:800px 100%;animation:shimmer 1.5s infinite;border-radius:var(--r);height:220px}
.gf-pc{background:var(--card);border:1px solid var(--bd);border-radius:16px;margin-bottom:1.25rem;overflow:hidden}.gf-hd{display:flex;align-items:center;gap:10px;padding:14px 16px;text-decoration:none;color:inherit}.gf-av{width:36px;height:36px;overflow:hidden;background:var(--al);display:flex;align-items:center;justify-content:center;flex-shrink:0}.gf-av img{width:100%;height:100%;object-fit:cover}.gf-meta{flex:1;min-width:0}.gf-name{font-weight:600;font-size:.875rem;display:flex;align-items:center;gap:6px}.gf-loc{font-size:.75rem;color:var(--t3)}.gf-time{font-size:.75rem;color:#999;flex-shrink:0}.gf-media{position:relative}.gf-mg{display:grid;gap:3px}.gf-mg img{width:100%;height:100%;object-fit:cover;display:block}.gf-over{position:absolute;bottom:0;right:0;width:calc(50% - 1.5px);height:calc(50% - 1.5px);background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.75rem;font-weight:700}.gf-acts{display:flex;align-items:center;gap:4px;padding:8px 16px}.gf-act{background:none;border:none;padding:6px 10px;border-radius:8px;cursor:pointer;color:var(--t3);font-family:var(--f);display:inline-flex;align-items:center;gap:4px;font-size:.875rem}.gf-act:hover{background:var(--al)}.gf-cap{padding:4px 16px 14px;font-size:.875rem;line-height:1.5}.gf-cap b{font-weight:600}.gf-cap .gf-more{color:var(--ac);cursor:pointer;font-size:.8125rem}.gf-txt{padding:20px 16px;font-size:1rem;line-height:1.65;color:var(--t2)}.gf-load{display:inline-block;padding:.625rem 1.5rem;border:1px solid var(--bd);border-radius:var(--rs);font-size:.875rem;color:var(--t2);cursor:pointer;background:var(--card);font-family:var(--f)}.gf-load:hover{border-color:var(--ac);color:var(--ac)}.gf-empty{text-align:center;padding:2rem;color:var(--t3)}

@media(max-width:768px){
  .ex-grid{grid-template-columns:repeat(2,1fr)}
}
@media(max-width:640px){
  .hero h1{font-size:1.75rem}
  .search-bar{flex-wrap:wrap}
  .s-loc{border-left:0;border-top:1px solid var(--bd);width:100%}
  .s-btn{width:calc(100% - 8px)}
  .grid{grid-template-columns:1fr}
  .nav-r .hm,.nav-dd{display:none}
  .hamburger{display:flex}
  .filters{overflow-x:auto;flex-wrap:nowrap;scrollbar-width:none}
  .filters::-webkit-scrollbar{display:none}
  .dp-header{flex-direction:column;align-items:center;text-align:center}
  .dp-grid{grid-template-columns:1fr}
  .dp-socials{justify-content:center}
}
/* LIGHTBOX */
.lb{display:none;position:fixed;inset:0;z-index:300;background:rgba(0,0,0,.92);justify-content:center;align-items:center;flex-direction:column;padding:1rem}
.lb.open{display:flex}
.lb-img{max-width:90vw;max-height:70vh;border-radius:8px;object-fit:contain;background:linear-gradient(135deg,var(--al),#c8dbd0);min-width:280px;min-height:280px;display:flex;align-items:center;justify-content:center;flex-direction:column}
.lb-info{text-align:center;margin-top:1rem;color:#fff}
.lb-info h4{font-size:1rem;font-weight:600;margin-bottom:.25rem}
.lb-info p{font-size:.8125rem;color:rgba(255,255,255,.7);margin-bottom:.75rem}
.lb-info .btn{background:rgba(255,255,255,.15);color:#fff;border:1px solid rgba(255,255,255,.25);backdrop-filter:blur(4px)}
.lb-info .btn:hover{background:rgba(255,255,255,.25)}
.lb-close{position:absolute;top:1rem;right:1rem;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.1);color:#fff;font-size:1.5rem;display:flex;align-items:center;justify-content:center}
.lb-close:hover{background:rgba(255,255,255,.2)}
.lb-nav{position:absolute;top:50%;transform:translateY(-50%);width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.1);color:#fff;font-size:1.25rem;display:flex;align-items:center;justify-content:center}
.lb-nav:hover{background:rgba(255,255,255,.2)}
.lb-prev{left:1rem}.lb-next{right:1rem}
</style>
</head>
<body>
<nav class="nav"><div class="nav-in">
  <div class="logo" onclick="goHome()" title="Hair Tattoo - SMP Artist Directory">Hair<span>Tattoo</span></div>
  <div class="nav-r">
    <a href="/near-me/" class="hm" title="Find SMP artists near you">Near Me</a>
    <div class="nav-dd" id="navDD">
      <button class="nav-dd-btn" title="Tools and resources for SMP professionals" onclick="document.getElementById('navDD').classList.toggle('open')">For Pros <svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></button>
      <div class="nav-menu">
        <a href="/for-professionals" title="Why SMP artists choose Hair Tattoo">Why Hair Tattoo?</a>
        <a href="/signup.html" class="primary" title="Create your free SMP artist profile">Create Your Page</a>
        <div class="nm-sep"></div>
        <a href="/signup.html?mode=signin" title="Sign in to your Hair Tattoo dashboard">Sign In</a>
      </div>
    </div>
    <button class="hamburger" onclick="document.getElementById('mobMenu').classList.add('open')"><svg viewBox="0 0 24 24"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
  </div>
</div></nav>
<div class="mob-menu" id="mobMenu" onclick="this.classList.remove('open')">
  <div class="mob-drawer" onclick="event.stopPropagation()">
    <span class="mob-close" onclick="document.getElementById('mobMenu').classList.remove('open')">&times;</span>
    <nav>
      <a href="/near-me/" title="Find SMP artists near you">Near Me</a>
      <a href="/for-professionals" title="Why SMP artists choose Hair Tattoo">Why Hair Tattoo?</a>
      <a href="/signup.html?mode=signin" title="Sign in to your Hair Tattoo dashboard">Sign In</a>
      <a href="/signup.html" title="Create your free SMP artist profile">Create Your Page</a>
    </nav>
  </div>
</div>

<!-- HOME VIEW -->
<div id="homeView">
  <section class="hero">
    <h1>Find an <em>SMP</em> Artist Near You</h1>
    <p>The #1 directory for scalp micropigmentation professionals. Browse 400+ verified SMP artists, compare services, and connect instantly.</p>
    <div class="hero-btns">
      <button class="btn btn-o" onclick="toggleGeo()" id="nearMeBtn" style="font-size:.8125rem">
        <svg class="icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg> Find Near Me
      </button>
      <button class="btn btn-o" onclick="showTab('feed')" style="font-size:.8125rem">
        <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg> Browse Artwork
      </button>
    </div>
  </section>
  <div class="search-wrap">
    <div class="search-bar">
      <input type="text" id="searchName" placeholder="Search artist or studio name..." oninput="doSearch()">
      <div class="s-loc">
        <svg class="icon" style="width:14px;height:14px;flex-shrink:0" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
        <input type="text" id="searchCity" placeholder="City or State" oninput="doSearch()">
      </div>
      <button class="s-btn" onclick="doSearch()">Search</button>
    </div>
  </div>
  <div class="featured-section" id="featuredSection" style="display:none">
    <h2>Featured Artists</h2>
    <div class="featured-row" id="featuredRow"></div>
  </div>
  <div class="tabs">
    <button class="tab on" onclick="showTab('directory')" id="tabDir">Directory</button>
    <button class="tab" onclick="showTab('feed')" id="tabFeed">Explore</button>
  </div>
  <div id="dirView">
    <div class="filters" id="filters">
      <button class="chip on" onclick="setFilter('all')">All</button>
      <button class="chip" onclick="setFilter('Hairline Restoration')">Hairline</button>
      <button class="chip" onclick="setFilter('Density Fill')">Density</button>
      <button class="chip" onclick="setFilter('Scar Camouflage')">Scar Camo</button>
      <button class="chip" onclick="setFilter('Female SMP')">Female SMP</button>
      <button class="chip" onclick="setFilter('Beard SMP')">Beard SMP</button>
      <button class="chip" onclick="setFilter('Alopecia Treatment')">Alopecia</button>
      <span class="fcount" id="resultCount"></span>
    </div>
    <div class="main"><div class="grid" id="listGrid"><div class="skel"></div><div class="skel"></div><div class="skel"></div><div class="skel"></div><div class="skel"></div><div class="skel"></div></div></div>
    <div class="pager" id="pager"></div>
  </div>
  <div id="feedView" style="display:none">
    <div class="explore-wrap">
      <div class="explore-toggle">
        <div class="toggle-group">
          <button class="toggle-btn active" data-view="feed" onclick="setExploreView('feed')">üì∞ Posts</button>
          <button class="toggle-btn" data-view="gallery" onclick="setExploreView('gallery')">üì∑ Gallery</button>
        </div>
        <span class="explore-count" id="exploreCount"></span>
      </div>
      <div id="exploreContainer"><div style="text-align:center;padding:2rem;color:#888">Loading posts...</div></div>
      <div style="text-align:center;margin-top:1rem" id="exploreLoadMore"></div>
    </div>
  </div>
</div>

<!-- DETAIL PAGE (hash routed) -->
<div class="detail-page" id="detailPage"></div>

<!-- SIGNUP MODAL -->
<!-- LIGHTBOX -->
<div class="lb" id="lightbox" onclick="if(event.target===this)closeLb()">
  <button class="lb-close" onclick="closeLb()">√ó</button>
  <button class="lb-nav lb-prev" onclick="lbNav(-1)">‚Äπ</button>
  <button class="lb-nav lb-next" onclick="lbNav(1)">‚Ä∫</button>
  <div class="lb-img" id="lbImg"></div>
  <div class="lb-info" id="lbInfo"></div>
</div>

<!-- MESSAGE PANEL -->
<div class="msg-overlay" id="msgOverlay" onclick="closeMsgPanel()"></div>
<div class="msg-panel" id="msgPanel">
  <div class="msg-panel-head">
    <h3 id="msgPanelTitle">Send a Message</h3>
    <button onclick="closeMsgPanel()" style="font-size:1.25rem;color:var(--t3);line-height:1">&times;</button>
  </div>
  <div class="msg-panel-body" id="msgPanelBody"></div>
</div>

<footer>
  <h4>Hair<span style="color:var(--al)">Tattoo</span></h4>
  <p>The #1 directory for scalp micropigmentation professionals in the United States. Connecting people with trusted SMP artists since 2025.</p>
  <div class="fc-wrap">
    <p class="fc-label">Popular Cities</p>
    <div class="fc-grid">
      <a href="/near-me/new-york-ny/" class="fc-link" title="SMP artists in New York, NY">New York, NY</a><a href="/near-me/los-angeles-ca/" class="fc-link" title="SMP artists in Los Angeles, CA">Los Angeles, CA</a><a href="/near-me/houston-tx/" class="fc-link" title="SMP artists in Houston, TX">Houston, TX</a><a href="/near-me/chicago-il/" class="fc-link" title="SMP artists in Chicago, IL">Chicago, IL</a><a href="/near-me/miami-beach-fl/" class="fc-link" title="SMP artists in Miami Beach, FL">Miami Beach, FL</a><a href="/near-me/atlanta-ga/" class="fc-link" title="SMP artists in Atlanta, GA">Atlanta, GA</a><a href="/near-me/phoenix-az/" class="fc-link" title="SMP artists in Phoenix, AZ">Phoenix, AZ</a><a href="/near-me/dallas-tx/" class="fc-link" title="SMP artists in Dallas, TX">Dallas, TX</a><a href="/near-me/san-francisco-ca/" class="fc-link" title="SMP artists in San Francisco, CA">San Francisco, CA</a><a href="/near-me/seattle-wa/" class="fc-link" title="SMP artists in Seattle, WA">Seattle, WA</a><a href="/near-me/boston-ma/" class="fc-link" title="SMP artists in Boston, MA">Boston, MA</a><a href="/near-me/denver-co/" class="fc-link" title="SMP artists in Denver, CO">Denver, CO</a><a href="/near-me/austin-tx/" class="fc-link" title="SMP artists in Austin, TX">Austin, TX</a><a href="/near-me/nashville-tn/" class="fc-link" title="SMP artists in Nashville, TN">Nashville, TN</a><a href="/near-me/tampa-fl/" class="fc-link" title="SMP artists in Tampa, FL">Tampa, FL</a><a href="/near-me/fort-lauderdale-fl/" class="fc-link" title="SMP artists in Fort Lauderdale, FL">Fort Lauderdale, FL</a><a href="/near-me/san-diego-ca/" class="fc-link" title="SMP artists in San Diego, CA">San Diego, CA</a><a href="/near-me/philadelphia-pa/" class="fc-link" title="SMP artists in Philadelphia, PA">Philadelphia, PA</a><a href="/near-me/charlotte-nc/" class="fc-link" title="SMP artists in Charlotte, NC">Charlotte, NC</a><a href="/near-me/las-vegas-nv/" class="fc-link" title="SMP artists in Las Vegas, NV">Las Vegas, NV</a><a href="/near-me/portland-or/" class="fc-link" title="SMP artists in Portland, OR">Portland, OR</a><a href="/near-me/scottsdale-az/" class="fc-link" title="SMP artists in Scottsdale, AZ">Scottsdale, AZ</a><a href="/near-me/boca-raton-fl/" class="fc-link" title="SMP artists in Boca Raton, FL">Boca Raton, FL</a><a href="/near-me/fort-worth-tx/" class="fc-link" title="SMP artists in Fort Worth, TX">Fort Worth, TX</a><a href="/near-me/beverly-hills-ca/" class="fc-link" title="SMP artists in Beverly Hills, CA">Beverly Hills, CA</a>
    </div>
  </div>
  <p style="font-size:.75rem;margin-top:1rem">&copy; 2025 Hair Tattoo. All rights reserved.</p>
  <div class="f-links">
    <a href="/for-professionals" title="Tools and resources for SMP professionals">For Professionals</a><a href="/privacy" title="Hair Tattoo Privacy Policy">Privacy</a><a href="/terms" title="Hair Tattoo Terms of Service">Terms</a><a href="/contact" title="Contact Hair Tattoo">Contact</a>
  </div>
</footer>

<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","name":"Hair Tattoo","alternateName":"HairTattoo.com","url":"https://hairtattoo.com","description":"The #1 directory for scalp micropigmentation professionals","potentialAction":{"@type":"SearchAction","target":"https://hairtattoo.com/?q={search_term_string}","query-input":"required name=search_term_string"}}
</script>

<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script>
let SB;
const SB_STORAGE='https://ingorrzmoudvoknhwjjb.supabase.co/storage/v1/object/public/';
function mediaUrl(m){if(typeof m==='string')return SB_STORAGE+'placeholders/'+encodeURIComponent(m);return SB_STORAGE+(m.is_placeholder?'placeholders':'media')+'/'+encodeURIComponent(m.storage_path);}
function listingUrl(l){return '/near-me/'+l.city.toLowerCase().replace(/\s+/g,'-')+'-'+l.state.toLowerCase()+'/'+l.slug;}
let L=[];
const _viewedAt={};
function trackView(listing){
  const now=Date.now();
  if(_viewedAt[listing.id]&&now-_viewedAt[listing.id]<30000)return;
  _viewedAt[listing.id]=now;
  SB.from('page_views').insert({listing_id:listing.id,path:listingUrl(listing)}).then(()=>{});
}

let filtered=[],currentFilter='all',page=1,currentTab='directory';
const PER=24;

// === HASH ROUTER (fallback ‚Äî redirects to clean URLs) ===
function route(){
  const hash=location.hash.slice(1);
  if(hash && hash!=='/'){
    const slug=hash.startsWith('/')?hash.slice(1):hash;
    const listing=L.find(l=>l.slug===slug);
    if(listing){location.replace(listingUrl(listing));return;}
  }
  showHome();
}
window.addEventListener('hashchange',route);

function goHome(){location.hash='';showHome();}

function showHome(){
  document.getElementById('homeView').style.display='';
  document.getElementById('detailPage').style.display='none';
  document.title='Hair Tattoo ‚Äî Find SMP Artists Near You';
}

// === DISTANCE ===
function dist(a,b,c,d){const R=3959,x=(c-a)*Math.PI/180,y=(d-b)*Math.PI/180;const s=Math.sin(x/2)**2+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(y/2)**2;return R*2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));}

// === SEARCH ===
function doSearch(){
  const q=(document.getElementById('searchName').value||'').toLowerCase().trim();
  const loc=(document.getElementById('searchCity').value||'').toLowerCase().trim();
  filtered=L.filter(l=>{
    let m=true;
    if(q) m=l.name.toLowerCase().includes(q)||l.about.toLowerCase().includes(q);
    if(loc&&m) m=l.city.toLowerCase().includes(loc)||l.state.toLowerCase()===loc||(l.city+', '+l.state).toLowerCase().includes(loc);
    if(currentFilter!=='all'&&m){
      m=l.services.includes(currentFilter);
    }
    return m;
  });
  page=1;render();
}

function setFilter(f){
  currentFilter=f;
  document.querySelectorAll('.chip').forEach(c=>{
    const t=c.textContent;
    c.classList.toggle('on',f==='all'?t==='All':t.includes(f)||(f==='$$$'&&t.includes('Premium'))||(f==='$$'&&t.includes('Standard')));
  });
  doSearch();
}

// === GEO ===
let geoActive=false;
function toggleGeo(){
  const b=document.getElementById('nearMeBtn');
  if(geoActive){
    geoActive=false;
    L.forEach(l=>delete l._dist);
    if(b)b.innerHTML='<svg class="icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg> Find Near Me';
    doSearch();
    return;
  }
  if(!navigator.geolocation)return;
  if(b)b.innerHTML='<span style="display:inline-block;animation:spin .8s linear infinite">\u27F3</span> Locating...';
  navigator.geolocation.getCurrentPosition(p=>{
    const lat=p.coords.latitude,lng=p.coords.longitude;
    L.forEach(l=>l._dist=dist(lat,lng,l.lat,l.lng));
    L.sort((a,bb)=>(a._dist||9999)-(bb._dist||9999));
    geoActive=true;
    // Find nearest city from listings
    const nearest=L[0];
    const cityLabel=nearest?nearest.city+', '+nearest.state:'Your Area';
    if(b)b.innerHTML='<svg class="icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg> '+cityLabel;
    doSearch();
  },()=>{if(b)b.innerHTML='<svg class="icon" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg> Find Near Me';});
}

// === BADGES ===
function getBadge(l){
  if(!l.claimed)return'';
  const hasReal=l._media&&l._media.some(m=>!m.is_placeholder);
  const ok=hasReal&&l.phone&&l.email&&l.services.length>=2&&l.about;
  if(ok)return'<span class="c-badge c-badge-verified">\u2713 Verified</span>';
  return'<span class="c-badge c-badge-claimed">Claimed</span>';
}
function isPromotedNow(l){return l.promoted&&l.promoted_until&&new Date(l.promoted_until)>new Date();}

// === RENDER DIRECTORY ===
function render(){
  const g=document.getElementById('listGrid'),s=(page-1)*PER,items=filtered.slice(s,s+PER);
  document.getElementById('resultCount').textContent=filtered.length+' artist'+(filtered.length!==1?'s':'');
  if(!items.length){g.innerHTML='<div class="empty" style="grid-column:1/-1"><h3>No artists found</h3><p>Try adjusting your search or filters</p></div>';document.getElementById('pager').innerHTML='';return;}
  g.innerHTML=items.map(l=>{
    const ini=l.name.split(' ').map(w=>w[0]).slice(0,2).join('');
    const pp=l._media&&l._media.find(m=>m.is_profile);
    const avR=isPromotedNow(l)?'12px':'50%';
    const avHTML=pp?`<img src="${mediaUrl(pp)}" alt="${l.name}" style="width:100%;height:100%;object-fit:cover;border-radius:${avR}">`:ini;
    const badge=getBadge(l);
    const d=l._dist?'<span style="margin-left:.25rem;font-size:.7rem;color:var(--t3)">'+Math.round(l._dist)+' mi</span>':'';
    return `<article class="card" onclick="location.href='${listingUrl(l)}'" title="${l.name} - SMP in ${l.city}, ${l.state}" itemscope itemtype="https://schema.org/LocalBusiness">
      <div class="c-head"><div class="c-av" style="border-radius:${avR}">${avHTML}</div><div class="c-info"><div class="c-name" itemprop="name">${l.name}</div><div class="c-loc"><svg class="icon" style="width:12px;height:12px" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg> <span itemprop="address">${l.city}, ${l.state}</span>${d}</div></div>${badge}</div>
      <div class="c-body"><p class="c-about" itemprop="description">${l.about}</p></div>
      <div class="c-tags">${l.services.slice(0,3).map(s=>'<span class="c-tag">'+s+'</span>').join('')}</div>
      <div class="c-foot"><span class="c-views">${l._views?'üëÅ '+l._views+' view'+(l._views!==1?'s':''):'New'}</span><span class="c-msg" onclick="event.stopPropagation();openMsgPanel(${l.id})"><svg class="icon" style="width:14px;height:14px" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg> Message</span></div>
    </article>`;
  }).join('');
  // pager
  const pages=Math.ceil(filtered.length/PER),pg=document.getElementById('pager');
  if(pages<=1){pg.innerHTML='';return;}
  let h='';
  if(page>1)h+='<button onclick="goPage('+(page-1)+')">‚Üê Prev</button>';
  const start=Math.max(1,page-3),end=Math.min(pages,start+6);
  for(let i=start;i<=end;i++)h+='<button class="'+(i===page?'on':'')+'" onclick="goPage('+i+')">'+i+'</button>';
  if(page<pages)h+='<button onclick="goPage('+(page+1)+')">Next ‚Üí</button>';
  pg.innerHTML=h;
}
function goPage(p){page=p;render();window.scrollTo({top:document.querySelector('.tabs').offsetTop-60,behavior:'smooth'});}

// === DETAIL PAGE ===
function showDetail(l){
  document.getElementById('homeView').style.display='none';
  const dp=document.getElementById('detailPage');
  dp.style.display='block';
  window.scrollTo(0,0);
  document.title=l.name+' ‚Äî SMP in '+l.city+', '+l.state+' | Hair Tattoo';
  trackView(l);

  const ini=l.name.split(' ').map(w=>w[0]).slice(0,2).join('');
  const soc=l.socials||{};
  // Badges
  let badgeHTML='';
  if(l.claimed){
    const hasReal=l._media&&l._media.some(m=>!m.is_placeholder);
    const ok=hasReal&&l.phone&&l.email&&l.services.length>=2&&l.about;
    if(ok)badgeHTML+='<span class="dp-badge dp-badge-verified">\u2713 Verified Business</span>';
  }
  if(isPromotedNow(l))badgeHTML+=(badgeHTML?' \u00b7 ':'')+'<span class="dp-badge dp-badge-featured">\u2B50 Featured Artist</span>';

  // Build social links
  let socHTML='';
  if(soc.instagram) socHTML+=`<a href="https://instagram.com/${soc.instagram}" target="_blank" rel="noopener" class="dp-social"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="5"/><circle cx="12" cy="12" r="5"/><circle cx="17.5" cy="6.5" r="1.5"/></svg> @${soc.instagram}</a>`;
  if(soc.facebook) socHTML+=`<a href="https://facebook.com/${soc.facebook}" target="_blank" rel="noopener" class="dp-social"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg> Facebook</a>`;
  if(soc.tiktok) socHTML+=`<a href="https://tiktok.com/@${soc.tiktok}" target="_blank" rel="noopener" class="dp-social">TikTok</a>`;
  if(l.website) socHTML+=`<a href="${l.website}" target="_blank" rel="noopener" class="dp-social"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg> Website</a>`;

  // Gallery images from media table
  const gMedia=l._media||[];
  let gallery='';
  if(gMedia.length){
    gallery=gMedia.map((m,i)=>`<div onclick="openLb(${l.id},${i})" style="border-radius:8px;overflow:hidden;position:relative;cursor:pointer;transition:transform .15s" onmouseover="this.style.transform='scale(1.03)'" onmouseout="this.style.transform=''"><img src="${mediaUrl(m.storage_path)}" loading="lazy" width="240" height="200" alt="${l.name}" style="width:100%;height:200px;object-fit:cover;display:block">${m.is_placeholder?'<span class="c-pill">üì∑ Sample photo</span>':''}</div>`).join('');
  } else {
    const colors=['#c8dbd0','#b8d0c2','#a8c5b4','#d4e4d9','#e0ebe5','#bcd4c6'];
    const glabels=['Before & After','Hairline Closeup','Density Session','Side Profile','Top View','Final Result'];
    for(let i=0;i<6;i++){
      gallery+=`<div style="background:${colors[i]};border-radius:8px;height:200px;display:flex;align-items:center;justify-content:center;flex-direction:column;color:var(--ac)"><span style="font-family:var(--se);font-size:1.5rem;opacity:.5">${ini}</span><span style="font-size:.6rem;opacity:.35;margin-top:.25rem">${glabels[i]}</span></div>`;
    }
  }

  dp.innerHTML=`
    <button class="dp-back" onclick="goHome()"><svg class="icon" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg> Back to directory</button>
    <div class="dp-header">
      <div class="dp-av">${ini}</div>
      <div class="dp-info">
        <h1 class="dp-name">${l.name}</h1>
        <div class="dp-loc">${l.address}, ${l.city}, ${l.state} ${l.zip}</div>
        ${badgeHTML?'<div style="margin-top:.25rem">'+badgeHTML+'</div>':''}
        <div class="dp-socials">${socHTML}</div>
      </div>
    </div>
    <div class="dp-section"><h3>About</h3><p class="dp-about">${l.about}</p></div>
    <div class="dp-section"><h3>Services Offered</h3><div class="dp-svcs">${l.services.map(s=>'<span>'+s+'</span>').join('')}</div></div>
    <div class="dp-section"><h3>Contact Information</h3><div class="dp-grid">
      <div class="dp-det"><label>Phone</label><a href="tel:${l.phone}">${l.phone}</a></div>
      <div class="dp-det"><label>Email</label><a href="mailto:${l.email}">${l.email}</a></div>
      <div class="dp-det"><label>Website</label><a href="${l.website}" target="_blank" rel="noopener">${l.website.replace(/https?:\/\//,'')}</a></div>
      <div class="dp-det"><label>Location</label><span>${l.city}, ${l.state} ${l.zip}</span></div>
    </div></div>
    <div class="dp-section"><h3>Gallery</h3><div style="display:grid;grid-template-columns:repeat(3,1fr);gap:6px">${gallery}</div><p style="font-size:.75rem;color:var(--t3);margin-top:.5rem;text-align:center">${l.claimed?'':'Photos will appear when this business claims their page'}</p></div>
    <div class="cf" id="cf-${l.id}">
      <h3>üì© Send a Message to ${l.name}</h3>
      <div class="cf-row"><input type="text" placeholder="Your Name" id="cfn-${l.id}"><input type="tel" placeholder="Your Phone" id="cfp-${l.id}"></div>
      <div class="cf-row"><textarea placeholder="Hi, I'm interested in learning more about your SMP services..." id="cfm-${l.id}"></textarea></div>
      <button class="cf-sub" onclick="sendMsg(${l.id})">Send Message ‚Üí</button>
    </div>
    ${!l.claimed?`<div class="dp-claim"><span style="flex:1">Claim this page to get verified and manage your listing.</span><button onclick="location.href='/signup.html?claim=${l.slug}'">Claim Page</button></div>`:''}
  `;

  // Inject structured data for this listing
  let sd=document.getElementById('listing-sd');
  if(sd)sd.remove();
  sd=document.createElement('script');sd.type='application/ld+json';sd.id='listing-sd';
  sd.textContent=JSON.stringify({"@context":"https://schema.org","@type":"LocalBusiness","name":l.name,"address":{"@type":"PostalAddress","streetAddress":l.address,"addressLocality":l.city,"addressRegion":l.state,"postalCode":l.zip,"addressCountry":"US"},"telephone":l.phone,"email":l.email,"url":l.website,"description":l.about,"geo":{"@type":"GeoCoordinates","latitude":l.lat,"longitude":l.lng},"makesOffer":l.services.map(s=>({"@type":"Offer","itemOffered":{"@type":"Service","name":s}}))});
  document.head.appendChild(sd);
}

async function sendMsg(id){
  const n=document.getElementById('cfn-'+id)?.value;
  const p=document.getElementById('cfp-'+id)?.value;
  const m=document.getElementById('cfm-'+id)?.value||'';
  if(!n||!p){alert('Please enter your name and phone number.');return;}
  const{error}=await SB.from('leads').insert({listing_id:id,sender_name:n,sender_phone:p,sender_message:m||null});
  if(error)console.error('Lead insert error:',error.message);
  document.getElementById('cf-'+id).innerHTML='<div class="cf-ok">‚úì Message sent! The artist will reach out to you shortly.</div>';
}

// === MESSAGE PANEL ===
let msgListingId=null;
function openMsgPanel(id){
  const l=L.find(x=>x.id===id);if(!l)return;
  msgListingId=id;
  document.getElementById('msgPanelTitle').textContent='Message '+l.name;
  const svcs=l.services.map(s=>`<span class="msg-svc" onclick="this.classList.toggle('on')">${s}</span>`).join('');
  document.getElementById('msgPanelBody').innerHTML=`
    <label class="mp-label">Your Name</label>
    <input type="text" id="mpName" placeholder="Full name">
    <label class="mp-label">Phone Number</label>
    <input type="tel" id="mpPhone" placeholder="(555) 123-4567">
    <label class="mp-label">Services Interested In</label>
    <div class="msg-svcs">${svcs}</div>
    <label class="mp-label">Message</label>
    <textarea id="mpMsg" placeholder="Hi, I'm interested in learning more about your SMP services..."></textarea>
    <label class="msg-consent"><input type="checkbox" id="mpConsent"> I agree to receive SMS/text messages from this business regarding my inquiry. Message & data rates may apply.</label>
    <button class="msg-submit" onclick="submitMsgPanel()">Send Message ‚Üí</button>
  `;
  document.getElementById('msgOverlay').classList.add('open');
  document.getElementById('msgPanel').classList.add('open');
  document.body.style.overflow='hidden';
}
function closeMsgPanel(){
  document.getElementById('msgOverlay').classList.remove('open');
  document.getElementById('msgPanel').classList.remove('open');
  document.body.style.overflow='';
  msgListingId=null;
}
async function submitMsgPanel(){
  const name=document.getElementById('mpName')?.value?.trim();
  const phone=document.getElementById('mpPhone')?.value?.trim();
  const msg=document.getElementById('mpMsg')?.value?.trim();
  const svcs=[...document.querySelectorAll('.msg-svc.on')].map(s=>s.textContent);
  if(!name||!phone){alert('Please enter your name and phone number.');return;}
  const fullMsg=(svcs.length?'Services: '+svcs.join(', ')+'\n\n':'')+(msg||'');
  const{error}=await SB.from('leads').insert({listing_id:msgListingId,sender_name:name,sender_phone:phone,sender_message:fullMsg||null});
  if(error){console.error('Lead insert error:',error.message);alert('Something went wrong. Please try again.');return;}
  document.getElementById('msgPanelBody').innerHTML='<div class="msg-ok"><h4>‚úì Message Sent!</h4><p>The artist will reach out to you shortly.</p><button class="btn btn-o" onclick="closeMsgPanel()">Close</button></div>';
}

// === LIGHTBOX ===
let lbItems=[],lbIdx=0;
function openLb(listingId,idx){
  const l=L.find(x=>x.id===listingId);if(!l)return;
  const media=l._media||[];
  if(media.length){
    lbItems=media.map(m=>({url:mediaUrl(m.storage_path),isPlaceholder:m.is_placeholder,listing:l}));
  } else {
    const ini=l.name.split(' ').map(w=>w[0]).slice(0,2).join('');
    const colors=['#c8dbd0','#b8d0c2','#a8c5b4','#d4e4d9','#e0ebe5','#bcd4c6'];
    lbItems=colors.map((c,i)=>({color:c,ini,listing:l}));
  }
  lbIdx=idx||0;
  renderLb();
  document.getElementById('lightbox').classList.add('open');
  document.body.style.overflow='hidden';
}
function renderLb(){
  const item=lbItems[lbIdx];if(!item)return;
  const imgEl=document.getElementById('lbImg');
  if(item.url){
    imgEl.style.background='#111';
    imgEl.innerHTML=`<img src="${item.url}" alt="${item.listing.name}" style="max-width:90vw;max-height:70vh;object-fit:contain;border-radius:8px">${item.isPlaceholder?'<span class="c-pill" style="bottom:1rem;left:1rem">üì∑ Sample photo</span>':''}`;
  } else {
    imgEl.style.background=`linear-gradient(135deg,${item.color},#c8dbd0)`;
    imgEl.innerHTML=`<span style="font-family:var(--se);font-size:3rem;color:var(--ac);opacity:.4">${item.ini}</span>`;
  }
  const dots=lbItems.length>1?`<div style="display:flex;gap:4px;justify-content:center;margin-top:.5rem">${lbItems.map((_,i)=>`<span style="width:6px;height:6px;border-radius:50%;background:${i===lbIdx?'#fff':'rgba(255,255,255,.4)'}"></span>`).join('')}</div>`:'';
  document.getElementById('lbInfo').innerHTML=`<h4>${item.listing.name}</h4><p>${item.listing.city}, ${item.listing.state}</p>${dots}<button class="btn" onclick="closeLb();location.href=listingUrl(item.listing)" style="margin-top:.5rem">View Business ‚Üí</button>`;
}
function closeLb(){document.getElementById('lightbox').classList.remove('open');document.body.style.overflow='';}
function lbNav(dir){lbIdx=(lbIdx+dir+lbItems.length)%lbItems.length;renderLb();}

// === EXPLORE TAB ===
let exploreView='feed';
function showTab(t){
  currentTab=t;
  document.getElementById('tabDir').classList.toggle('on',t==='directory');
  document.getElementById('tabFeed').classList.toggle('on',t==='feed');
  document.getElementById('dirView').style.display=t==='directory'?'':'none';
  document.getElementById('feedView').style.display=t==='feed'?'':'none';
  if(t==='feed'&&!gfPosts.length)loadExplorePosts(false);
}

function setExploreView(v){
  exploreView=v;
  document.querySelectorAll('.explore-toggle .toggle-btn').forEach(b=>b.classList.toggle('active',b.dataset.view===v));
  renderExplore();
}

function renderExplore(){
  const c=document.getElementById('exploreContainer');
  const ct=document.getElementById('exploreCount');
  if(ct)ct.textContent=gfPosts.length+' post'+(gfPosts.length!==1?'s':'');
  if(!gfPosts.length){c.innerHTML='<div class="gf-empty">No posts yet \u2014 SMP artists, <a href="/for-professionals">share your latest work!</a></div>';return;}
  exploreView==='gallery'?renderExploreGrid(c):renderExploreFeed(c);
}

function renderExploreFeed(c){
  let h='';
  gfPosts.forEach(p=>{h+=renderGfPost(p);});
  c.innerHTML=h||'<div class="gf-empty">No posts yet</div>';
}

function renderExploreGrid(c){
  let h='<div class="ex-grid">';
  gfPosts.forEach((p,i)=>{
    const media=(p.media||[]).filter(m=>!m.is_profile&&!m.is_cover);
    if(media.length){
      media.forEach(m=>{
        h+='<div class="ex-grid-item"><img src="'+gfMurl(m)+'" loading="lazy" alt=""></div>';
      });
    } else if(p.body){
      h+='<div class="ex-grid-item ex-grid-txt"><p>'+gfEsc(p.body)+'</p></div>';
    }
  });
  h+='</div>';
  c.innerHTML=h;
}

// === SIGNUP ===
// Moved to /signup.html (multi-step page builder)

// === INIT ===
async function initApp(){
  SB=window.supabase.createClient('https://ingorrzmoudvoknhwjjb.supabase.co','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImluZ29ycnptb3Vkdm9rbmh3ampiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA2NDY1NTIsImV4cCI6MjA4NjIyMjU1Mn0.rpcraVuvgRWX1NJtZyUQAzDp4rZhw4cpRm4dRx9yxJc');
  // Fetch listings from Supabase
  const{data,error}=await SB.from('listings').select('*');
  if(error){console.error('Failed to load listings:',error.message);document.getElementById('listGrid').innerHTML='<div class="empty" style="grid-column:1/-1"><h3>Failed to load listings</h3><p>Please refresh the page</p></div>';return;}
  // Map DB columns to app format
  L=data.map(r=>({
    id:r.id,name:r.name,slug:r.slug,city:r.city,state:r.state,
    address:r.address||'',zip:r.zip||'',phone:r.phone||'',email:r.email||'',
    website:r.website||'',lat:r.lat,lng:r.lng,about:r.about||'',
    services:r.services||[],claimed:r.claimed||false,
    promoted:r.promoted||false,promoted_until:r.promoted_until||null,
    socials:{instagram:r.instagram||'',facebook:r.facebook||'',tiktok:r.tiktok||''}
  }));
  // Fetch view counts
  const{data:viewStats,error:vsErr}=await SB.from('listing_stats').select('id,view_count');
  if(!vsErr&&viewStats){const vc={};viewStats.forEach(s=>vc[s.id]=s.view_count||0);L.forEach(l=>l._views=vc[l.id]||0);}
  // Fetch media for all listings
  const{data:mediaData}=await SB.from('media').select('*').order('sort_order',{ascending:true});
  if(mediaData){const mm={};mediaData.forEach(m=>{if(!mm[m.listing_id])mm[m.listing_id]=[];mm[m.listing_id].push(m);});L.forEach(l=>l._media=mm[l.id]||[]);}
  // Featured Artists
  const promoted=L.filter(l=>isPromotedNow(l));
  if(promoted.length){
    document.getElementById('featuredSection').style.display='';
    document.getElementById('featuredRow').innerHTML=promoted.map(l=>{
      const ini=l.name.split(' ').map(w=>w[0]).slice(0,2).join('');
      const pp=l._media&&l._media.find(m=>m.is_profile);
      const avHTML=pp?`<img src="${mediaUrl(pp)}" alt="${l.name}" style="width:100%;height:100%;object-fit:cover;border-radius:12px">`:ini;
      const badge=getBadge(l);
      const thumbImg=l._media&&(l._media.find(m=>m.is_cover)||l._media.find(m=>!m.is_profile&&!m.is_cover&&!m.is_placeholder)||l._media.find(m=>!m.is_profile&&!m.is_cover));
      const thumb=thumbImg?`<div class="c-img"><span class="c-featured-pill">\u2B50 Featured</span><img src="${mediaUrl(thumbImg)}" loading="lazy" width="400" height="180" alt="${l.name} SMP">${thumbImg.is_placeholder?'<span class="c-pill">\uD83D\uDCF7 Sample photo</span>':''}</div>`:'';
      return `<article class="card" onclick="location.href='${listingUrl(l)}'">
        ${thumb}
        <div class="c-head"><div class="c-av" style="border-radius:12px">${avHTML}</div><div class="c-info"><div class="c-name">${l.name}</div><div class="c-loc"><svg class="icon" style="width:12px;height:12px" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg> ${l.city}, ${l.state}</div></div>${badge}</div>
        <div class="c-body"><p class="c-about">${l.about}</p></div>
        <div class="c-tags">${l.services.slice(0,3).map(s=>'<span class="c-tag">'+s+'</span>').join('')}</div>
      </article>`;
    }).join('');
  }
  filtered=[...L];
  doSearch();
  // Schema for top listings
  L.slice(0,20).forEach(l=>{const s=document.createElement('script');s.type='application/ld+json';s.textContent=JSON.stringify({"@context":"https://schema.org","@type":"LocalBusiness","name":l.name,"address":{"@type":"PostalAddress","streetAddress":l.address,"addressLocality":l.city,"addressRegion":l.state,"postalCode":l.zip},"telephone":l.phone,"url":l.website,"geo":{"@type":"GeoCoordinates","latitude":l.lat,"longitude":l.lng}});document.head.appendChild(s);});
  // Route
  route();
  // Auth-aware nav
  SB.auth.onAuthStateChange((ev,session)=>{
    const dd=document.getElementById('navDD');
    if(session&&session.user&&dd){
      const em=session.user.email||'';
      const ini=em.split('@')[0].slice(0,2).toUpperCase();
      dd.outerHTML=`<a href="/dashboard.html" style="display:flex;align-items:center;gap:.5rem;font-size:.875rem;font-weight:500;color:var(--text)"><span style="width:32px;height:32px;border-radius:50%;background:var(--al);display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;color:var(--ac)">${ini}</span>Dashboard</a>`;
    }
  });
}
document.addEventListener('DOMContentLoaded',()=>initApp());
document.addEventListener('click',e=>{var d=document.getElementById('navDD');if(d&&!d.contains(e.target))d.classList.remove('open')});

document.addEventListener('keydown',e=>{
  if(e.key==='Escape'){closeMsgPanel();closeLb();document.getElementById('mobMenu')?.classList.remove('open');}
  if(document.getElementById('lightbox').classList.contains('open')){
    if(e.key==='ArrowLeft')lbNav(-1);
    if(e.key==='ArrowRight')lbNav(1);
  }
});

// ‚îÄ‚îÄ Explore Posts ‚îÄ‚îÄ
let gfPosts=[],gfOffset=0;const GF_LIMIT=20;
const GF_SB_URL='https://ingorrzmoudvoknhwjjb.supabase.co';const GF_SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImluZ29ycnptb3Vkdm9rbmh3ampiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA2NDY1NTIsImV4cCI6MjA4NjIyMjU1Mn0.rpcraVuvgRWX1NJtZyUQAzDp4rZhw4cpRm4dRx9yxJc';
function gfMurl(m){return GF_SB_URL+'/storage/v1/object/public/'+(m.is_placeholder?'placeholders':'media')+'/'+m.storage_path;}
function gfRelTime(d){const s=Math.floor((Date.now()-new Date(d).getTime())/1000);if(s<60)return 'just now';const m=Math.floor(s/60);if(m<60)return m+'m ago';const h=Math.floor(m/60);if(h<24)return h+'h ago';const dy=Math.floor(h/24);if(dy<7)return dy+'d ago';const w=Math.floor(dy/7);if(w<5)return w+'w ago';return new Date(d).toLocaleDateString('en',{month:'short',day:'numeric'});}
function gfEsc(s){return s?s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'):''}
function gfCitySlug(c,st){return c.toLowerCase().replace(/\s+/g,'-')+'-'+st.toLowerCase();}

async function loadExplorePosts(append){
  const lm=document.getElementById('exploreLoadMore');
  if(!append){document.getElementById('exploreContainer').innerHTML='<div style="text-align:center;padding:2rem;color:#888">Loading posts...</div>';}
  try{
    const res=await fetch(GF_SB_URL+'/rest/v1/posts?order=created_at.desc&limit='+GF_LIMIT+'&offset='+gfOffset+'&select=*,listings(id,name,slug,city,state,promoted,promoted_until),media(*)',{headers:{'apikey':GF_SB_KEY,'Authorization':'Bearer '+GF_SB_KEY}});
    const posts=await res.json()||[];
    if(!append)gfPosts=[];
    gfPosts=gfPosts.concat(posts);
    gfOffset+=posts.length;
    renderExplore();
    lm.innerHTML=posts.length>=GF_LIMIT?'<button class="gf-load" onclick="loadExplorePosts(true)">Load More</button>':'';
  }catch(e){document.getElementById('exploreContainer').innerHTML='<div class="gf-empty">Could not load posts</div>';}
}

function renderGfPost(p){
  const l=p.listings;if(!l)return '';
  const media=(p.media||[]).filter(m=>!m.is_profile&&!m.is_cover);
  const isProm=l.promoted&&l.promoted_until&&new Date(l.promoted_until)>new Date();
  const avR=isProm?'border-radius:12px':'border-radius:50%';
  const cs=gfCitySlug(l.city,l.state);
  const href='/near-me/'+cs+'/'+l.slug;
  const ini=l.name.split(' ').map(w=>w[0]).slice(0,2).join('');
  let h='<div class="gf-pc"><a class="gf-hd" href="'+href+'">';
  h+='<div class="gf-av" style="'+avR+'"><span style="font-family:var(--se);font-size:.875rem;color:var(--ac)">'+ini+'</span></div>';
  h+='<div class="gf-meta"><div class="gf-name">'+gfEsc(l.name)+(isProm?' \u2B50':'')+'</div><div class="gf-loc">'+gfEsc(l.city)+', '+gfEsc(l.state)+'</div></div>';
  h+='<span class="gf-time">'+gfRelTime(p.created_at)+'</span></a>';
  if(media.length)h+=renderGfMedia(media);
  else if(p.body)h+='<div class="gf-txt">'+gfEsc(p.body).replace(/\n/g,'<br>')+'</div>';
  h+='<div class="gf-acts"><button class="gf-act">\u2665 <span>0</span></button><button class="gf-act">\uD83D\uDCAC <span>0</span></button><button class="gf-act" style="margin-left:auto">\uD83D\uDD16</button></div>';
  if(media.length&&p.body){const body=gfEsc(p.body);h+='<div class="gf-cap"><b><a href="'+href+'" style="color:inherit;text-decoration:none">'+gfEsc(l.name)+'</a></b> ';if(body.length>200)h+='<span data-full="'+body.replace(/"/g,'&quot;')+'">'+body.substring(0,200)+'...<span class="gf-more" onclick="this.parentElement.textContent=this.parentElement.dataset.full">more</span></span>';else h+=body;h+='</div>';}
  h+='</div>';return h;
}

function renderGfMedia(media){
  const n=media.length;let h='<div class="gf-media">';
  if(n===1){h+='<div class="gf-mg" style="grid-template-columns:1fr"><div style="aspect-ratio:4/5"><img src="'+gfMurl(media[0])+'" loading="lazy"></div></div>';}
  else if(n===2){h+='<div class="gf-mg" style="grid-template-columns:1fr 1fr">';for(let i=0;i<2;i++)h+='<div style="aspect-ratio:4/5"><img src="'+gfMurl(media[i])+'" loading="lazy"></div>';h+='</div>';}
  else if(n===3){h+='<div class="gf-mg" style="grid-template-columns:1.2fr 1fr;grid-template-rows:1fr 1fr"><div style="grid-row:1/3"><img src="'+gfMurl(media[0])+'" loading="lazy" style="height:100%"></div><div><img src="'+gfMurl(media[1])+'" loading="lazy" style="height:100%"></div><div><img src="'+gfMurl(media[2])+'" loading="lazy" style="height:100%"></div></div>';}
  else{h+='<div class="gf-mg" style="grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;aspect-ratio:1">';for(let i=0;i<Math.min(4,n);i++){h+='<div style="position:relative"><img src="'+gfMurl(media[i])+'" loading="lazy" style="height:100%">';if(i===3&&n>4)h+='<div class="gf-over">+'+(n-3)+'</div>';h+='</div>';}h+='</div>';}
  h+='</div>';return h;
}
</script>
</body>
</html>
